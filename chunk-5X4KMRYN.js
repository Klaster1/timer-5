import{b as pt,c as dt}from"./chunk-HIIVH6YS.js";import"./chunk-PKS27IFN.js";import{a as St,c as vt,d as yt,e as Dt,f as wt}from"./chunk-LW6TPO6S.js";import{c as ct,e as lt,f as L,g as R,h as ut,i as ft,r as B,s as xt}from"./chunk-4H7SYSUS.js";import{a as mt,b as _t}from"./chunk-6QGYDCWD.js";import"./chunk-ODUPONNJ.js";import{D as gt,Q as Tt,g as E,i as ot,j as at,k as rt,l as z,m as st,v as A,w as kt,y as Ct}from"./chunk-LPE4Z74E.js";import{a as ht}from"./chunk-WYM2PP4O.js";import{C as Z,G as S,H as tt,K as et,Pa as F,Qa as it,Ra as nt,h as G,k as Q}from"./chunk-3ZE7BWPT.js";import{$b as l,Ca as k,Cb as p,Da as C,Db as D,Eb as w,Gb as _,Ja as j,La as v,Lb as u,Lc as I,Nc as O,Pb as o,Qb as a,Rb as f,Sb as J,Tb as U,Ub as g,Zb as h,a as W,hb as s,ic as $,jc as c,kc as M,lc as b,na as m,nc as X,pc as V,ra as Y,rc as d,sb as K,sc as x,ta as y,tc as P,ua as H,vb as q}from"./chunk-XDEH7EXF.js";var Vt=(()=>{class t{constructor(){this.transform=gt}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275pipe=H({name:"tasksDuration",type:t,pure:!0,standalone:!0})}}return t})();var Pt=(()=>{class t{constructor(){this.viewport=m(S),this.checkViewportSizeWhenValueChanges=v(),O(()=>{this.checkViewportSizeWhenValueChanges(),this.viewport.checkViewportSize()})}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275dir=y({type:t,selectors:[["","checkViewportSizeWhenValueChanges",""]],inputs:{checkViewportSizeWhenValueChanges:[1,"checkViewportSizeWhenValueChanges"]},standalone:!0})}}return t})();var Ot=(()=>{class t{constructor(){this.viewport=m(S),this.itemSize=v(),this.scrollToIndex=v(),O(()=>{let e=this.scrollToIndex(),i=this.itemSize();if(!A(e)||e===-1||!i){this.previousIndex=e;return}let n=e*i,T=A(this.previousIndex)?void 0:"smooth";setTimeout(()=>{this.viewport.scrollToOffset(n-this.viewport.getViewportSize()/2,T),this.previousIndex=e})})}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275dir=y({type:t,selectors:[["","scrollToIndex",""]],inputs:{itemSize:[1,"itemSize"],scrollToIndex:[1,"scrollToIndex"]},standalone:!0})}}return t})();var bt=()=>[import("./chunk-ONCUUUZK.js").then(t=>t.TasksFilterComponent)],It=()=>[import("./chunk-ORBCEZPX.js").then(t=>t.EmptyStateComponent),z,F],Et=()=>[import("./chunk-ORBCEZPX.js").then(t=>t.EmptyStateComponent),E,F],Ft=t=>({"task-opened":t}),zt=t=>[t],Lt=t=>({running:t});function Rt(t,r){t&1&&(o(0,"span",5),c(1),a()),t&2&&(s(),b(" (",r,") "))}function Bt(t,r){if(t&1){let e=g();o(0,"tasks-filter",8),h("keyup.esc",function(){k(e);let n=l(3);return C(n.toggleFilter(!1))}),a()}}function At(t,r){t&1&&(p(0,Bt,1,0),D(1,0,bt),w())}function Nt(t,r){if(t&1){let e=g();o(0,"mat-list-item",13),h("cdkDropListDropped",function(n){let T=k(e).$implicit,Mt=l(3);return C(Mt.onDrop(n,T))}),o(1,"div",14)(2,"a",15,1),f(4,"mat-icon",16),d(5,"taskStateIcon"),d(6,"map"),o(7,"span",17),c(8),a(),o(9,"span",18),c(10),d(11,"taskDuration"),d(12,"formatDuration"),d(13,"async"),a()(),f(14,"button-task-actions",19),a()()}if(t&2){let e=r.$implicit,i=$(3),n=l(3);_("activated",i.isActive),s(2),_("routerLink",V(19,zt,e.id)),s(2),_("svgIcon",x(5,7,e))("ngClass",V(21,Lt,P(6,9,e,n.isTaskRunning))),s(4),M(e.name),s(2),M(x(13,17,x(12,15,P(11,12,e,5e3)))),s(4),_("task",e)}}function Wt(t,r){if(t&1){let e=g();o(0,"button",9),h("click",function(){k(e);let n=l(2);return C(n.store.createTask())}),f(1,"mat-icon",10),a(),o(2,"cdk-virtual-scroll-viewport",11,0)(4,"mat-nav-list"),p(5,Nt,15,23,"mat-list-item",12),a()()}if(t&2){let e=l(),i=l();s(2),_("itemSize",48)("scrollToIndex",i.store.currentTaskIndex())("checkViewportSizeWhenValueChanges",e),s(3),_("cdkVirtualForOf",e)("cdkVirtualForTrackBy",i.taskId)}}function Yt(t,r){t&1&&c(0," Create a task and it will show up here ")}function Ht(t,r){t&1&&c(0," Create a task and it will show up here ")}function jt(t,r){t&1&&c(0," You didn't finish any tasks yet ")}function Kt(t,r){t&1&&c(0," You didn't abandon any tasks yet ")}function qt(t,r){if(t&1){let e=g();o(0,"empty-state"),f(1,"img",20),o(2,"span",21),c(3,"No tasks"),a(),o(4,"span",22),p(5,Yt,1,0)(6,Ht,1,0)(7,jt,1,0)(8,Kt,1,0),a(),o(9,"button",23),h("click",function(){k(e);let n=l(4);return C(n.store.createTask())}),c(10," Create a task "),a()()}if(t&2){let e,i=l(4);s(5),u((e=i.store.currentTaskState())==="all"?5:e===i.taskState.active?6:e===i.taskState.finished?7:e===i.taskState.dropped?8:-1)}}function Jt(t,r){t&1&&(p(0,qt,11,1),D(1,0,It),w())}function Ut(t,r){if(t&1){let e=g();o(0,"empty-state"),f(1,"mat-icon",24),o(2,"span",21),c(3,"Nothing found"),a(),o(4,"span",22),c(5,"Could not find tasks matching the criteria"),a(),o(6,"button",25),h("click",function(){k(e);let n=l(4);return C(n.toggleFilter(!1))}),c(7,"Reset filter"),a()()}}function $t(t,r){t&1&&(p(0,Ut,8,0),D(1,0,Et),w())}function Xt(t,r){if(t&1&&p(0,Jt,3,0)(1,$t,3,0),t&2){let e=l(2);u(e.searchOpened()===!1?0:1)}}function Gt(t,r){if(t&1){let e=g();o(0,"section",3)(1,"mat-toolbar")(2,"h1"),J(3),c(4),d(5,"taskState"),U(),p(6,Rt,2,1,"span",5),d(7,"tasksDuration"),d(8,"formatDuration"),d(9,"async"),a(),o(10,"button",6),h("click",function(){k(e);let n=l();return C(n.toggleFilter())}),f(11,"mat-icon",7),a()(),p(12,At,3,0)(13,Wt,6,5)(14,Xt,2,1),a()}if(t&2){let e,i=r,n=l();s(4),b(" ",x(5,4,n.store.currentTaskState())," "),s(2),u((e=x(9,11,x(8,9,P(7,6,i,2e4))))?6:-1,e),s(6),u(n.searchOpened()?12:-1),s(),u(i.length?13:14)}}function Qt(t,r){t&1&&(o(0,"section",4),f(1,"router-outlet"),a())}var Re=(()=>{class t{constructor(){this.store=m(Tt),this.keys=m(_t),this.router=m(rt),this.destroyRef=m(j),this.filterPresent=I(()=>!!Object.keys(this.store.decodedFilterParams()).length),this.filterToggles=q(void 0),this.searchOpened=I(()=>{let e=this.filterPresent(),i=this.filterToggles();return i!==void 0?i:e}),this.taskState=kt,this.isTaskRunning=Ct,this.taskId=(e,i)=>i.id,this.hotkeys=[B(ut,"Add task",()=>this.store.createTask()),B([...L,...R],"Next/prev task",e=>{let i=this.store.currentTaskState(),n=L.includes(e.key)?this.store.nextTaskId():R.includes(e.key)?this.store.prevTaskId():null;i&&n&&this.router.navigate([i,n],{queryParamsHandling:"merge"})}),new mt(ft,e=>(e.preventDefault(),this.toggleFilter(),!0),["INPUT"],"Toggle search")],K(()=>{this.keys.add(this.hotkeys)}),this.destroyRef.onDestroy(()=>{this.keys.remove(this.hotkeys)})}toggleFilter(e){this.filterToggles.update(()=>e??!this.searchOpened())}onDrop(e,i){this.store.moveSessionToTask(e.item.data[1],i.id,W({},e.item.data[0]))}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=Y({type:t,selectors:[["screen-tasks"]],standalone:!0,features:[X],decls:3,vars:5,consts:[["scroll",""],["rla","routerLinkActive"],[1,"container",3,"ngClass"],[1,"tasks"],[1,"task","mat-app-background"],["data-e2e","screen-tasks__total",1,"state-duration"],["mat-icon-button","","matTooltip","Toggle filter panel",3,"click"],["svgIcon","filter_list"],[3,"keyup.esc"],["mat-fab","","color","accent","data-e2e","button-add-task","matTooltip","Create a task",3,"click"],["svgIcon","add"],[3,"itemSize","scrollToIndex","checkViewportSizeWhenValueChanges"],["cdkDropList","","data-e2e","screen-tasks__task-item",3,"activated","cdkDropListDropped",4,"cdkVirtualFor","cdkVirtualForOf","cdkVirtualForTrackBy"],["cdkDropList","","data-e2e","screen-tasks__task-item",3,"cdkDropListDropped","activated"],[1,"item-content"],["matLine","","queryParamsHandling","merge","fixRouterLinkActive","","routerLinkActive","",1,"task-link",3,"routerLink"],["data-e2e","screen-tasks__task-state-icon",3,"svgIcon","ngClass"],["data-e2e","screen-tasks__task-name",1,"name"],["data-e2e","screen-tasks__task-duration",1,"duration"],[3,"task"],["src","assets/favicon.svg","alt","Timer","illustration",""],["title",""],["subtitle",""],["color","primary","mat-raised-button","","type","button","routerLink","/tasks/active","data-e2e","screen-tasks__button-add-task-empty-state",3,"click"],["color","accent","illustration","","svgIcon","search"],["mat-raised-button","","type","button",3,"click"]],template:function(i,n){if(i&1&&(o(0,"div",2),p(1,Gt,15,13,"section",3)(2,Qt,2,0,"section",4),a()),i&2){let T;_("ngClass",V(3,Ft,n.store.isCurrentTaskOpened())),s(),u((T=n.store.currentTasks())?1:-1,T),s(),u(n.store.isCurrentTaskOpened()?2:-1)}},dependencies:[vt,Dt,wt,Vt,xt,z,at,st,et,Z,tt,S,St,E,nt,it,dt,pt,ot,yt,ht,lt,ct,Pt,Ot,Q,G],styles:[`[_nghost-%COMP%]{display:contents}.container[_ngcontent-%COMP%]{display:grid;grid-template-rows:1fr;flex:1;--fab-offset: 1rem}@media (min-width: 900px){.container[_ngcontent-%COMP%]:not(.task-opened){grid-template-areas:"left tasks right";grid-template-columns:1fr 50% 1fr}.container.task-opened[_ngcontent-%COMP%]{grid-template-areas:"tasks task";grid-template-columns:1fr 1fr}}@media (max-width: 900px){.container[_ngcontent-%COMP%]{grid-template-columns:[tasks-start task-start] 1fr;grid-template-rows:[tasks-start task-start] 1fr}.container[_ngcontent-%COMP%]   .task[_ngcontent-%COMP%]{z-index:1}}.task-link[_ngcontent-%COMP%]{flex:1;padding:calc((48px - 1.25em)/2) 0!important;display:grid;grid-template-columns:auto 1fr auto;align-items:center;color:inherit;font-weight:400}.task-link[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:.25em}.task-link[_ngcontent-%COMP%]   mat-icon.running[_ngcontent-%COMP%]{color:var(--primary-darker-color)!important}.duration[_ngcontent-%COMP%]{margin-left:auto}.name[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis}.tasks[_ngcontent-%COMP%]{grid-area:tasks;position:relative;max-height:100vh;display:flex;flex-direction:column}.task[_ngcontent-%COMP%]{grid-area:task;display:flex;flex-direction:column;overflow:hidden}mat-toolbar[_ngcontent-%COMP%]{flex:0 0 auto}[mat-fab][_ngcontent-%COMP%]{position:absolute;bottom:var(--fab-offset);right:var(--fab-offset);left:50%;z-index:10}.active[_ngcontent-%COMP%]{background:var(--active-link-background)}h1[_ngcontent-%COMP%]{width:100%}.search-form[_ngcontent-%COMP%], h1[_ngcontent-%COMP%]{display:flex;align-items:center}.range-filter[_ngcontent-%COMP%]{margin-left:auto;flex:0 0 42.5px}.search-form[_ngcontent-%COMP%]{margin-left:auto}.state-duration[_ngcontent-%COMP%]{margin-left:.25em}.filter-trigger-icon[_ngcontent-%COMP%]{position:relative;top:3px}cdk-virtual-scroll-viewport[_ngcontent-%COMP%]{flex:1}empty-state[_ngcontent-%COMP%]{margin:auto}.cdk-drop-list-dragging[_ngcontent-%COMP%]{position:relative}.cdk-drop-list-dragging[_ngcontent-%COMP%]:after{display:block;content:"";position:absolute;inset:0;border:dotted 2px grey}.item-content[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}
/*# sourceMappingURL=screen-tasks.component-2TDJJNYL.css.map */`],changeDetection:0})}}return t})();export{Re as default};
//# sourceMappingURL=chunk-5X4KMRYN.js.map
