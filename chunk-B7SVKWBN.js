import{a as Mt,b as Pt,d as Tt,e as Ot,f as Dt}from"./chunk-LW6TPO6S.js";import{a as ct,c as mt,d as dt,m as gt,n as bt,o as kt,p as xt,q as Ct,r as x,s as St}from"./chunk-4H7SYSUS.js";import{b as ht}from"./chunk-6QGYDCWD.js";import"./chunk-ODUPONNJ.js";import{A,B as vt,P as z,Q as V,g as E,i as lt,l as R,p as pt,q as _t,r as ut,s as ft,w as F,y as yt}from"./chunk-LPE4Z74E.js";import{a as wt}from"./chunk-WYM2PP4O.js";import{C as ot,G as v,H as it,I as at,K as rt,Qa as st,Ra as I,i as tt,k as et,l as nt}from"./chunk-3ZE7BWPT.js";import{$b as m,Ca as g,Cb as f,Da as b,Gb as l,Ja as S,La as B,Lb as P,Lc as J,Ma as Y,Nc as W,Pb as i,Qb as o,Rb as c,Sb as Q,Tb as j,Ub as C,Zb as k,gc as U,hb as r,hc as $,ic as T,jc as s,kc as G,lc as y,na as u,nc as O,pc as Z,qc as X,ra as w,rc as p,sb as M,sc as h,ta as H,tc as D,wb as N}from"./chunk-XDEH7EXF.js";function Ft(n,_){if(n&1){let t=C();i(0,"button",4),k("click",function(){g(t);let a=m();return b(a.edit())}),s(1,"Edit"),o(),i(2,"button",5),k("click",function(){g(t);let a=m();return b(a.remove())}),s(3,"Delete"),o(),i(4,"a",6),s(5,"Skip everything after"),o(),i(6,"a",7),s(7,"Skip everything before"),o()}if(n&2){let t=m();r(4),l("queryParams",t.skipAfterParams),r(2),l("queryParams",t.skipBeforeParams)}}var It=(()=>{class n{constructor(){this.store=u(V),this.task=B.required(),this.session=B.required()}edit(){this.store.editSession(this.task().id,A(this.session()))}remove(){this.store.deleteSession(this.task().id,A(this.session()))}get skipBeforeParams(){return z({from:new Date(this.session().start)})}get skipAfterParams(){return z({to:new Date(this.session()?.end??new Date)})}static{this.\u0275fac=function(e){return new(e||n)}}static{this.\u0275cmp=w({type:n,selectors:[["button-session-actions"]],inputs:{task:[1,"task"],session:[1,"session"]},standalone:!0,features:[O],decls:5,vars:1,consts:[["menu","matMenu"],["mat-icon-button","",3,"matMenuTriggerFor"],["svgIcon","more_vert"],["matMenuContent",""],["mat-menu-item","","type","button","data-e2e","menu-session__button-edit",3,"click"],["mat-menu-item","","type","button","data-e2e","menu-session__button-delete",3,"click"],["mat-menu-item","","type","button","routerLink",".","queryParamsHandling","merge","data-e2e","menu-session__button-skip-after",3,"queryParams"],["mat-menu-item","","type","button","routerLink",".","queryParamsHandling","merge","data-e2e","menu-session__button-skip-before",3,"queryParams"]],template:function(e,a){if(e&1&&(i(0,"button",1),c(1,"mat-icon",2),o(),i(2,"mat-menu",null,0),f(4,Ft,8,2,"ng-template",3),o()),e&2){let d=T(3);l("matMenuTriggerFor",d)}},dependencies:[ut,_t,pt,ft,I,E,R],styles:[`[_nghost-%COMP%]{display:inline-block}
/*# sourceMappingURL=button-session-actions.component-VXZK24TZ.css.map */`],changeDetection:0})}}return n})();var Rt=(()=>{class n{constructor(){this.elementRef=u(Y),this.destroyRef=u(S),M(()=>{let t=this.elementRef.nativeElement.querySelector("thead"),e=this.elementRef.nativeElement.querySelector("tfoot"),a=this.elementRef.nativeElement.parentElement;if(!a||!t||!e)return;t.style.position="sticky",t.style.zIndex="10",e.style.position="sticky",e.style.zIndex="10";let d=new MutationObserver(Vt=>{let{transform:Bt}=(Vt.at(0)?.target).style,L=Bt.replace("translateY(","").replace("px)",""),q=`-${L}px`,K=`${L}px`;t.style.top!==q&&(t.style.top=q),e.style.bottom!==K&&(e.style.bottom=K)});d.observe(a,{attributes:!0,attributeFilter:["style"]}),this.destroyRef.onDestroy(()=>d.disconnect())})}static{this.\u0275fac=function(e){return new(e||n)}}static{this.\u0275dir=H({type:n,selectors:[["","sticky",""]],standalone:!0})}}return n})();var At=n=>({top:n}),zt=(n,_)=>[n,_];function Lt(n,_){n&1&&c(0,"div")}function qt(n,_){if(n&1&&(Q(0),i(1,"tr",20),f(2,Lt,1,0,"div",21),i(3,"td",22),s(4),p(5,"date"),o(),i(6,"td",23),s(7),p(8,"date"),o(),i(9,"td",24),s(10),p(11,"map"),p(12,"formatDuration"),p(13,"async"),o(),i(14,"td",25),c(15,"button-session-actions",26),o()(),j()),n&2){let t=_.$implicit,e=m(),a=m();r(),l("cdkDragData",X(19,zt,t,e.id)),r(3),y(" ",D(5,6,t.start,"yyyy-MM-dd H:mm")," "),r(3),y(" ",D(8,9,t.end,"yyyy-MM-dd H:mm")," "),r(3),y(" ",h(13,17,h(12,15,D(11,12,t,a.sessionDuration)))," "),r(5),l("session",t)("task",e)}}function Kt(n,_){if(n&1){let t=C();i(0,"button",27),k("click",function(){g(t);let a=m(),d=m();return b(d.start(a.id))}),c(1,"mat-icon",28),o()}}function Ht(n,_){if(n&1){let t=C();i(0,"button",29),k("click",function(){g(t);let a=m(),d=m();return b(d.stop(a.id))}),c(1,"mat-icon",30),o()}}function Yt(n,_){if(n&1&&(i(0,"mat-toolbar")(1,"button",1),c(2,"mat-icon",2),o(),i(3,"h2"),c(4,"mat-icon",3),p(5,"taskStateIcon"),i(6,"span",4),s(7),o()(),c(8,"button-task-actions",5),o(),i(9,"cdk-virtual-scroll-viewport",6,0)(11,"table",7)(12,"thead",8)(13,"tr",9)(14,"th",10),s(15,"Start"),o(),i(16,"th",11),s(17,"End"),o(),i(18,"th",12),s(19,"Duration"),o(),c(20,"th",13),o()(),i(21,"tbody"),f(22,qt,16,22,"ng-container",14),o(),i(23,"tfoot")(24,"tr",15)(25,"td",16),s(26,"Total"),o(),c(27,"td",16),i(28,"td",17),s(29),p(30,"taskDuration"),p(31,"formatDuration"),p(32,"async"),o(),c(33,"td",16),o()()()(),f(34,Kt,2,0,"button",18)(35,Ht,2,0,"button",19)),n&2){let t=_,e=T(10),a=m();r(4),l("svgIcon",h(5,10,t)),r(3),G(t.name),r(),l("task",t),r(),l("itemSize",52),r(2),l("cdkDropListSortingDisabled",!0),r(),l("ngStyle",Z(18,At,"-"+e.getOffsetToRenderedContentStart()+"px")),r(10),l("cdkVirtualForOf",t.sessions),r(7),y(" ",h(32,16,h(31,14,h(30,12,t)))," "),r(5),P(a.taskIsInProgress()===!1?34:-1),r(),P(a.taskIsInProgress()===!0?35:-1)}}var Te=(()=>{class n{constructor(){this.store=u(V),this.keys=u(ht),this.destroyRef=u(S),this.taskIsInProgress=J(()=>yt(this.store.currentTask())),this.viewport=N(v),this.sessionDuration=vt,this.hotkeys=[x(gt,"Start/stop task",t=>{let e=this.store.currentTask(),a=this.taskIsInProgress();e&&(a?this.stop(e.id):this.start(e.id))}),x(bt,"Mark as finished",t=>{let e=this.store.currentTask();e&&this.store.updateTaskState(e.id,F.finished)}),x(kt,"Mark as active",t=>{let e=this.store.currentTask();e&&this.store.updateTaskState(e.id,F.active)}),x(xt,"Rename task",()=>{let t=this.store.currentTask();t&&this.store.renameTask(t.id)}),x(Ct,"Delete task",()=>{let t=this.store.currentTask();t&&this.store.deleteTask(t.id)})],this.displayedColumns=["start","end","duration","action"],this.destroyRef.onDestroy(()=>{this.keys.remove(this.hotkeys)}),M(()=>{this.keys.add(this.hotkeys)}),W(()=>{this.store.currentTaskId(),this.viewport()?.scrollToIndex(0)})}start(t){this.store.startTask(t,Date.now())}stop(t){this.store.stopTask(t,Date.now())}deleteTask(t){this.store.deleteTask(t.id)}static{this.\u0275fac=function(e){return new(e||n)}}static{this.\u0275cmp=w({type:n,selectors:[["screen-task"]],viewQuery:function(e,a){e&1&&U(a.viewport,v,5),e&2&&$()},standalone:!0,features:[O],decls:1,vars:1,consts:[["viewport",""],["routerLink","./..","queryParamsHandling","merge","mat-icon-button",""],["svgIcon","arrow_back"],["data-e2e","screen-task__state-icon",1,"fix-icon-color",3,"svgIcon"],["data-e2e","screen-task__name"],[3,"task"],["minBufferPx","200","maxBufferPx","2000",3,"itemSize"],["cdkDropList","","cdkVirtualScrollingElement","","sticky","",1,"mat-mdc-table",3,"cdkDropListSortingDisabled"],[3,"ngStyle"],[1,"mat-mdc-header-row","mdc-data-table__header-row"],[1,"header-start","mat-mdc-header-cell","mdc-data-table__header-cell"],[1,"header-end","mat-mdc-header-cell","mdc-data-table__header-cell"],[1,"header-duration","mat-mdc-header-cell","mdc-data-table__header-cell"],[1,"header-action","mat-mdc-header-cell","mdc-data-table__header-cell"],[4,"cdkVirtualFor","cdkVirtualForOf"],[1,"mat-mdc-footer-row","mdc-data-table__row"],[1,"mat-mdc-footer-cell","mdc-data-table__cell"],["data-e2e","screen-task__task-duration",1,"mat-mdc-footer-cell","mdc-data-table__cell"],["mat-fab","","color","accent","matTooltip","Start","data-e2e","screen-task__button-start"],["mat-fab","","color","primary","matTooltip","Stop","data-e2e","screen-task__button-stop"],["data-e2e","screen-task__session-row","cdkDrag","",1,"mat-mdc-row","mdc-data-table__row",3,"cdkDragData"],[4,"cdkDragPlaceholder"],["data-e2e","screen-task__session-start",1,"mat-mdc-cell","mdc-data-table__cell"],["data-e2e","screen-task__session-end",1,"mat-mdc-cell","mdc-data-table__cell"],["data-e2e","screen-task__session-duration",1,"mat-mdc-cell","mdc-data-table__cell"],[1,"mat-mdc-cell","mdc-data-table__cell"],["data-e2e","screen-task__button-session-action",3,"session","task"],["mat-fab","","color","accent","matTooltip","Start","data-e2e","screen-task__button-start",3,"click"],["svgIcon","play_arrow"],["mat-fab","","color","primary","matTooltip","Stop","data-e2e","screen-task__button-stop",3,"click"],["svgIcon","pause"]],template:function(e,a){if(e&1&&f(0,Yt,36,20),e&2){let d;P((d=a.store.currentTask())?0:-1,d)}},dependencies:[St,Pt,Mt,E,lt,Ot,Dt,Tt,It,wt,ct,dt,mt,et,nt,R,I,st,rt,ot,it,v,at,tt,Rt],styles:[`[_nghost-%COMP%]{position:relative;flex:1;flex-direction:column;max-height:100vh;display:grid;grid-template-rows:auto 1fr;padding-right:2px}h2[_ngcontent-%COMP%]{margin-right:auto;overflow:hidden;text-overflow:ellipsis;margin-bottom:2px}h2[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{position:relative;top:4px;margin-right:.25em}[mat-fab][_ngcontent-%COMP%]{position:absolute;bottom:var(--fab-offset);right:var(--fab-offset);left:50%;z-index:10}.session-tabular-data[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr 1fr}mat-toolbar[_ngcontent-%COMP%]{grid-row:1}.header-start[_ngcontent-%COMP%], .header-end[_ngcontent-%COMP%]{width:50%}.header-duration[_ngcontent-%COMP%]{max-width:90px;min-width:90px}.header-action[_ngcontent-%COMP%]{max-width:40px;min-width:40px}cdk-virtual-scroll-viewport[_ngcontent-%COMP%]{grid-row:2}
/*# sourceMappingURL=screen-task.component-GGEHVFCL.css.map */`,`.mat-mdc-table[_ngcontent-%COMP%]{min-width:100%;border:0;border-spacing:0;table-layout:auto;white-space:normal;background-color:var(--mat-table-background-color)}.mdc-data-table__cell[_ngcontent-%COMP%]{box-sizing:border-box;overflow:hidden;text-align:left;text-overflow:ellipsis}.mdc-data-table__cell[_ngcontent-%COMP%], .mdc-data-table__header-cell[_ngcontent-%COMP%]{padding:0 16px}.mat-mdc-header-row[_ngcontent-%COMP%]{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;height:var(--mat-table-header-container-height, 56px);color:var(--mat-table-header-headline-color, rgba(0, 0, 0, .87));font-family:var(--mat-table-header-headline-font, Roboto, sans-serif);line-height:var(--mat-table-header-headline-line-height);font-size:var(--mat-table-header-headline-size, 14px);font-weight:var(--mat-table-header-headline-weight, 500)}.mat-mdc-row[_ngcontent-%COMP%]{height:var(--mat-table-row-item-container-height, 52px);color:var(--mat-table-row-item-label-text-color, rgba(0, 0, 0, .87))}.mat-mdc-row[_ngcontent-%COMP%], .mdc-data-table__content[_ngcontent-%COMP%]{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:var(--mat-table-row-item-label-text-font, Roboto, sans-serif);line-height:var(--mat-table-row-item-label-text-line-height);font-size:var(--mat-table-row-item-label-text-size, 14px);font-weight:var(--mat-table-row-item-label-text-weight)}.mat-mdc-footer-row[_ngcontent-%COMP%]{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;height:var(--mat-table-footer-container-height, 52px);color:var(--mat-table-row-item-label-text-color, rgba(0, 0, 0, .87));font-family:var(--mat-table-footer-supporting-text-font, Roboto, sans-serif);line-height:var(--mat-table-footer-supporting-text-line-height);font-size:var(--mat-table-footer-supporting-text-size, 14px);font-weight:var(--mat-table-footer-supporting-text-weight);letter-spacing:var(--mat-table-footer-supporting-text-tracking)}.mat-mdc-header-cell[_ngcontent-%COMP%]{border-bottom-color:var(--mat-table-row-item-outline-color, rgba(0, 0, 0, .12));border-bottom-width:var(--mat-table-row-item-outline-width, 1px);border-bottom-style:solid;letter-spacing:var(--mat-table-header-headline-tracking);font-weight:inherit;line-height:inherit;box-sizing:border-box;text-overflow:ellipsis;overflow:hidden;outline:none;text-align:left}.mat-mdc-cell[_ngcontent-%COMP%]{border-bottom-color:var(--mat-table-row-item-outline-color, rgba(0, 0, 0, .12));border-bottom-width:var(--mat-table-row-item-outline-width, 1px);border-bottom-style:solid;letter-spacing:var(--mat-table-row-item-label-text-tracking);line-height:inherit}.mdc-data-table__row[_ngcontent-%COMP%]:last-child   .mat-mdc-cell[_ngcontent-%COMP%]{border-bottom:none}.mat-mdc-footer-cell[_ngcontent-%COMP%]{letter-spacing:var(--mat-table-row-item-label-text-tracking)}.mat-mdc-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%], .mat-mdc-table[_ngcontent-%COMP%]   tfoot[_ngcontent-%COMP%], .mat-mdc-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%], .mat-mdc-cell[_ngcontent-%COMP%], .mat-mdc-footer-cell[_ngcontent-%COMP%], .mat-mdc-header-row[_ngcontent-%COMP%], .mat-mdc-row[_ngcontent-%COMP%], .mat-mdc-footer-row[_ngcontent-%COMP%], .mat-mdc-table[_ngcontent-%COMP%]   .mat-mdc-header-cell[_ngcontent-%COMP%]{background:inherit}.mat-mdc-table[_ngcontent-%COMP%]   mat-header-row.mat-mdc-header-row[_ngcontent-%COMP%], .mat-mdc-table[_ngcontent-%COMP%]   mat-row.mat-mdc-row[_ngcontent-%COMP%], .mat-mdc-table[_ngcontent-%COMP%]   mat-footer-row.mat-mdc-footer-cell[_ngcontent-%COMP%]{height:unset}
/*# sourceMappingURL=mat-table-OV2V3RQE.css.map */`],changeDetection:0})}}return n})();export{Te as default};
//# sourceMappingURL=chunk-B7SVKWBN.js.map
