import{b as dt,c as _t}from"./chunk-YNKYKGRA.js";import{a as yt,c as wt,d as Dt,e as Vt,f as Pt}from"./chunk-ZH4LFN5Z.js";import{c as pt,e as mt,f as F,g as z,h as kt,i as Ct,r as L,s as St}from"./chunk-67WQ24C5.js";import{a as ut,b as ft}from"./chunk-HQ663PHB.js";import"./chunk-U4TP6YLV.js";import{D as xt,Q as vt,g as I,i as at,j as st,k as ct,l as E,m as lt,v as R,w as gt,y as ht}from"./chunk-VGRJF5ZH.js";import"./chunk-J5T6QRAO.js";import{a as Tt}from"./chunk-GZ6P4SP5.js";import{C as tt,G as S,H as et,K as it,Pa as nt,Qa as ot,Ra as rt,h as Q,k as Z}from"./chunk-SULJYRYA.js";import{Ca as k,Cb as p,Da as C,Db as P,Eb as j,Fb as K,Gb as q,Hb as U,Ja as N,Jb as _,La as v,Ob as u,Oc as b,Qc as V,Sb as o,Tb as r,Ub as f,Vb as $,Wb as X,Xb as g,ac as h,cc as c,hb as s,lc as G,mc as l,na as d,nc as O,oc as M,qc as J,ra as A,sb as H,sc as w,ta as y,ua as W,uc as m,vb as Y,vc as x,wc as D}from"./chunk-7MIOHV2N.js";var Ot=(()=>{class t{constructor(){this.transform=xt}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275pipe=W({name:"tasksDuration",type:t,pure:!0,standalone:!0})}}return t})();var Mt=(()=>{class t{constructor(){this.viewport=d(S),this.checkViewportSizeWhenValueChanges=v(),V(()=>{this.checkViewportSizeWhenValueChanges(),this.viewport.checkViewportSize()})}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275dir=y({type:t,selectors:[["","checkViewportSizeWhenValueChanges",""]],inputs:{checkViewportSizeWhenValueChanges:[1,"checkViewportSizeWhenValueChanges"]},standalone:!0})}}return t})();var bt=(()=>{class t{constructor(){this.viewport=d(S),this.itemSize=v(),this.scrollToIndex=v(),V(()=>{let e=this.scrollToIndex(),i=this.itemSize();if(!R(e)||e===-1||!i){this.previousIndex=e;return}let n=e*i,T=R(this.previousIndex)?void 0:"smooth";setTimeout(()=>{this.viewport.scrollToOffset(n-this.viewport.getViewportSize()/2,T),this.previousIndex=e})})}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275dir=y({type:t,selectors:[["","scrollToIndex",""]],inputs:{itemSize:[1,"itemSize"],scrollToIndex:[1,"scrollToIndex"]},standalone:!0})}}return t})();var Et=()=>[import("./chunk-ZAINNAUI.js").then(t=>t.TasksFilterComponent)],Ft=()=>[import("./chunk-2DBCAJAQ.js").then(t=>t.EmptyStateComponent),E,I,nt],zt=t=>({"task-opened":t}),Lt=t=>[t],Rt=t=>({running:t});function Bt(t,a){t&1&&(o(0,"span",6),l(1),r()),t&2&&(s(),M(" (",a,") "))}function At(t,a){if(t&1){let e=g();o(0,"tasks-filter",9),h("keyup.esc",function(){k(e);let n=c(3);return C(n.toggleFilter(!1))}),r()}}function Wt(t,a){if(t&1&&p(0,At,1,0,"tasks-filter"),t&2){let e=c(2);u(e.searchOpened()?0:-1)}}function Nt(t,a){if(t&1){let e=g();o(0,"mat-list-item",14),h("cdkDropListDropped",function(n){let T=k(e).$implicit,It=c(3);return C(It.onDrop(n,T))}),o(1,"div",15)(2,"a",16,2),f(4,"mat-icon",17),m(5,"taskStateIcon"),m(6,"map"),o(7,"span",18),l(8),r(),o(9,"span",19),l(10),m(11,"taskDuration"),m(12,"formatDuration"),m(13,"async"),r()(),f(14,"button-task-actions",20),r()()}if(t&2){let e=a.$implicit,i=G(3),n=c(3);_("activated",i.isActive),s(2),_("routerLink",w(19,Lt,e.id)),s(2),_("svgIcon",x(5,7,e))("ngClass",w(21,Rt,D(6,9,e,n.isTaskRunning))),s(4),O(e.name),s(2),O(x(13,17,x(12,15,D(11,12,e,5e3)))),s(4),_("task",e)}}function Ht(t,a){if(t&1){let e=g();o(0,"button",10),h("click",function(){k(e);let n=c(2);return C(n.store.createTask())}),f(1,"mat-icon",11),r(),o(2,"cdk-virtual-scroll-viewport",12,1)(4,"mat-nav-list"),p(5,Nt,15,23,"mat-list-item",13),r()()}if(t&2){let e=c(),i=c();s(2),_("itemSize",48)("scrollToIndex",i.store.currentTaskIndex())("checkViewportSizeWhenValueChanges",e),s(3),_("cdkVirtualForOf",e)("cdkVirtualForTrackBy",i.taskId)}}function Yt(t,a){t&1&&l(0," Create a task and it will show up here ")}function jt(t,a){t&1&&l(0," Create a task and it will show up here ")}function Kt(t,a){t&1&&l(0," You didn't finish any tasks yet ")}function qt(t,a){t&1&&l(0," You didn't abandon any tasks yet ")}function Ut(t,a){if(t&1){let e=g();o(0,"empty-state"),f(1,"img",21),o(2,"span",22),l(3,"No tasks"),r(),o(4,"span",23),p(5,Yt,1,0)(6,jt,1,0)(7,Kt,1,0)(8,qt,1,0),r(),o(9,"button",24),h("click",function(){k(e);let n=c(4);return C(n.store.createTask())}),l(10," Create a task "),r()()}if(t&2){let e,i=c(4);s(5),u((e=i.store.currentTaskState())==="all"?5:e===i.taskState.active?6:e===i.taskState.finished?7:e===i.taskState.dropped?8:-1)}}function $t(t,a){if(t&1){let e=g();o(0,"empty-state"),f(1,"mat-icon",25),o(2,"span",22),l(3,"Nothing found"),r(),o(4,"span",23),l(5,"Could not find tasks matching the criteria"),r(),o(6,"button",26),h("click",function(){k(e);let n=c(4);return C(n.toggleFilter(!1))}),l(7,"Reset filter"),r()()}}function Xt(t,a){if(t&1&&p(0,Ut,11,1,"empty-state")(1,$t,8,0,"empty-state"),t&2){let e=c(3);u(e.searchOpened()===!1?0:1)}}function Gt(t,a){t&1&&(p(0,Xt,2,1),P(1,0,Ft),K())}function Jt(t,a){if(t&1){let e=g();o(0,"section",4)(1,"mat-toolbar")(2,"h1"),$(3),l(4),m(5,"taskState"),X(),p(6,Bt,2,1,"span",6),m(7,"tasksDuration"),m(8,"formatDuration"),m(9,"async"),r(),o(10,"button",7,0),h("click",function(){k(e);let n=c();return C(n.toggleFilter())}),f(12,"mat-icon",8),r()(),p(13,Wt,1,1),P(14,13,Et),q(10),U(10),p(16,Ht,6,5)(17,Gt,3,0),r()}if(t&2){let e,i=a,n=c();s(4),M(" ",x(5,4,n.store.currentTaskState())," "),s(2),u((e=x(9,11,x(8,9,D(7,6,i,2e4))))?6:-1,e),s(8),j(n.searchOpened()),s(2),u(i.length?16:17)}}function Qt(t,a){t&1&&(o(0,"section",5),f(1,"router-outlet"),r())}var Re=(()=>{class t{constructor(){this.store=d(vt),this.keys=d(ft),this.router=d(ct),this.destroyRef=d(N),this.filterPresent=b(()=>!!Object.keys(this.store.decodedFilterParams()).length),this.filterToggles=Y(void 0),this.searchOpened=b(()=>{let e=this.filterPresent(),i=this.filterToggles();return i!==void 0?i:e}),this.taskState=gt,this.isTaskRunning=ht,this.taskId=(e,i)=>i.id,this.hotkeys=[L(kt,"Add task",()=>this.store.createTask()),L([...F,...z],"Next/prev task",e=>{let i=this.store.currentTaskState(),n=F.includes(e.key)?this.store.nextTaskId():z.includes(e.key)?this.store.prevTaskId():null;i&&n&&this.router.navigate([i,n],{queryParamsHandling:"merge"})}),new ut(Ct,e=>(e.preventDefault(),this.toggleFilter(),!0),["INPUT"],"Toggle search")],H(()=>{this.keys.add(this.hotkeys)}),this.destroyRef.onDestroy(()=>{this.keys.remove(this.hotkeys)})}toggleFilter(e){this.filterToggles.update(()=>e??!this.searchOpened())}onDrop({item:{data:[e,i]}},n){e&&i&&this.store.moveSessionToTask(i,n.id,e)}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=A({type:t,selectors:[["screen-tasks"]],standalone:!0,features:[J],decls:3,vars:5,consts:[["toggle",""],["scroll",""],["rla","routerLinkActive"],[1,"container",3,"ngClass"],[1,"tasks"],[1,"task","mat-app-background"],["data-e2e","screen-tasks__total",1,"state-duration"],["mat-icon-button","","matTooltip","Toggle filter panel",3,"click"],["svgIcon","filter_list"],[3,"keyup.esc"],["mat-fab","","color","accent","data-e2e","button-add-task","matTooltip","Create a task",3,"click"],["svgIcon","add"],[3,"itemSize","scrollToIndex","checkViewportSizeWhenValueChanges"],["cdkDropList","","data-e2e","screen-tasks__task-item",3,"activated","cdkDropListDropped",4,"cdkVirtualFor","cdkVirtualForOf","cdkVirtualForTrackBy"],["cdkDropList","","data-e2e","screen-tasks__task-item",3,"cdkDropListDropped","activated"],[1,"item-content"],["matLine","","queryParamsHandling","merge","fixRouterLinkActive","","routerLinkActive","",1,"task-link",3,"routerLink"],["data-e2e","screen-tasks__task-state-icon",3,"svgIcon","ngClass"],["data-e2e","screen-tasks__task-name",1,"name"],["data-e2e","screen-tasks__task-duration",1,"duration"],[3,"task"],["src","assets/favicon.svg","alt","Timer","illustration",""],["title",""],["subtitle",""],["color","primary","mat-raised-button","","type","button","routerLink","/tasks/active","data-e2e","screen-tasks__button-add-task-empty-state",3,"click"],["color","accent","illustration","","svgIcon","search"],["mat-raised-button","","type","button",3,"click"]],template:function(i,n){if(i&1&&(o(0,"div",3),p(1,Jt,18,13,"section",4)(2,Qt,2,0,"section",5),r()),i&2){let T;_("ngClass",w(3,zt,n.store.isCurrentTaskOpened())),s(),u((T=n.store.currentTasks())?1:-1,T),s(),u(n.store.isCurrentTaskOpened()?2:-1)}},dependencies:[wt,Vt,Pt,Ot,St,E,st,lt,it,tt,et,S,yt,I,rt,ot,_t,dt,at,Dt,Tt,mt,pt,Mt,bt,Z,Q],styles:[`[_nghost-%COMP%]{display:contents}.container[_ngcontent-%COMP%]{display:grid;grid-template-rows:1fr;flex:1;--fab-offset: 1rem}@media (min-width: 900px){.container[_ngcontent-%COMP%]:not(.task-opened){grid-template-areas:"left tasks right";grid-template-columns:1fr 50% 1fr}.container.task-opened[_ngcontent-%COMP%]{grid-template-areas:"tasks task";grid-template-columns:1fr 1fr}}@media (max-width: 900px){.container[_ngcontent-%COMP%]{grid-template-columns:[tasks-start task-start] 1fr;grid-template-rows:[tasks-start task-start] 1fr}.container[_ngcontent-%COMP%]   .task[_ngcontent-%COMP%]{z-index:1}}.task-link[_ngcontent-%COMP%]{flex:1;padding:calc((48px - 1.25em)/2) 0!important;display:grid;grid-template-columns:auto 1fr auto;align-items:center;color:inherit;font-weight:400}.task-link[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:.25em}.task-link[_ngcontent-%COMP%]   mat-icon.running[_ngcontent-%COMP%]{background:var(--timer-logo-color);color:var(--mat-app-background-color);border-radius:100%}.duration[_ngcontent-%COMP%]{margin-left:auto}.name[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis}.tasks[_ngcontent-%COMP%]{grid-area:tasks;position:relative;max-height:100vh;display:flex;flex-direction:column}.task[_ngcontent-%COMP%]{grid-area:task;display:flex;flex-direction:column;overflow:hidden}mat-toolbar[_ngcontent-%COMP%]{flex:0 0 auto}[mat-fab][_ngcontent-%COMP%]{position:absolute;bottom:var(--fab-offset);right:var(--fab-offset);left:50%;z-index:10}.active[_ngcontent-%COMP%]{background:var(--active-link-background)}h1[_ngcontent-%COMP%]{width:100%}.search-form[_ngcontent-%COMP%], h1[_ngcontent-%COMP%]{display:flex;align-items:center}.range-filter[_ngcontent-%COMP%]{margin-left:auto;flex:0 0 42.5px}.search-form[_ngcontent-%COMP%]{margin-left:auto}.state-duration[_ngcontent-%COMP%]{margin-left:.25em}.filter-trigger-icon[_ngcontent-%COMP%]{position:relative;top:3px}cdk-virtual-scroll-viewport[_ngcontent-%COMP%]{flex:1}empty-state[_ngcontent-%COMP%]{margin:auto}.cdk-drop-list-dragging[_ngcontent-%COMP%]{position:relative}.cdk-drop-list-dragging[_ngcontent-%COMP%]:after{display:block;content:"";position:absolute;inset:0;border:dotted 2px grey}.item-content[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}
/*# sourceMappingURL=screen-tasks.component-35T5S2WH.css.map */`],changeDetection:0})}}return t})();export{Re as default};
//# sourceMappingURL=chunk-TNXWGRYK.js.map
